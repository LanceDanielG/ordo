<div class="todo-card shadow-sm" [class.completed]="todo.completed" cdkDrag>
    <div class="priority-strip" [ngClass]="todo.priority"></div>
    
    <div class="actions-overlay">
        <button (click)="onToggleRequest()" title="Toggle Complete">
            <span class="material-icons">{{ todo.completed ? 'undo' : 'check_circle' }}</span>
        </button>
        <button (click)="onDeleteRequest($event)" title="Delete Task">
            <span class="material-icons">delete</span>
        </button>
    </div>

    <div class="todo-content">
        <h4 class="todo-text">{{ todo.text }}</h4>
    </div>

    <div class="todo-footer">
        <div class="tags">
            <span class="project-tag" *ngIf="project" [style.background]="project.color + '20'" [style.color]="project.color">
                {{ project.name }}
            </span>
        </div>

        <div class="assignee">
            <div class="assignee-avatar" [class.active]="assignee" [title]="assignee ? (assignee.full_name || assignee.email) : 'Unassigned'">
                {{ assignee ? (assignee.full_name || assignee.email).charAt(0).toUpperCase() : '?' }}
            </div>
        </div>
    </div>

    <!-- Confirmation Overlay -->
    <div class="confirm-overlay" *ngIf="confirmAction" (click)="$event.stopPropagation()">
        <p>Are you sure you want to {{ confirmAction }}?</p>
        <div class="confirm-btns">
            <button class="btn-cancel" (click)="confirmAction = null">Cancel</button>
            <button class="btn-confirm" (click)="onConfirm()">Confirm</button>
        </div>
    </div>
</div>
